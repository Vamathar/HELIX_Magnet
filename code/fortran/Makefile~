SDIR=src
HEATSRC=heatsrc/heat_mag.f90
HEATOBJ=$(HEATSRC:.f90=.o)
EXECUTABLE=helixtest
PROGRAMF=HELIXtest.f90
SOURCESF=MagnetLib.f90
MODULESF=RotationMod.f90 CoilDataMod.f90
OBJECTSF=$(MODULESF:.f90=.o)
FC=gfortran
FFLAGS=

$(EXECUTABLE): $(patsubst %,$(SDIR)/%,$(SOURCESF) $(OBJECTSF) $(PROGRAMF)) $(HEATOBJ)
	mv -f *.mod $(SDIR) || true
	$(FC) -o $@ $^ $(FFLAGS)

$(SDIR)/%Mod.o: $(SDIR)/%Mod.f90
	$(FC) -c $< -o $@

$(HEATOBJ):$(HEATSRC)
	$(FC) -c $< -o $@ 


.PHONY: clean

clean:
	rm -f $(SDIR)/*.o $(SDIR)/*.mod $(SDIR)/*~ $(EXECUTABLE)
